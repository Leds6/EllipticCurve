<!DOCTYPE html>
<html>
<head>
	<title>Elliptic</title>
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<meta charset="utf-8">
</head>
<body>

	<div id="page_container">
		<div id="left_column">
			<div class="card">
				<canvas id="canvas" width="700" height="700"></canvas>
			</div>
		</div>

		<div id="right_column">
			<h1 class="title">ELLIPTIC CURVE</h1>
			<div class="card" >
				<div id="equation">
					<span>y<sup>2</sup> = x<sup>3</sup> + <input type="number" name="" id="a"> x + <input type="number" name="" id="b"></span> mod(<input type="number" name="" id="m"></span>)
				</div>
				<div id ="equation_info"></div>
			</div>
			<div class="card menu_card">
				<div class="menu">
					<button class="Bouton" name="add">Addition</button>
					<button class="Bouton" name="mul">Multiplier</div>
				
				
				<div id="content_container">
					<div id="info" name="m1">Click on a point (add)</div>
					<div id="info" class="tonDiv" name="m2">Click on a point (mult)</BR> Enter n :<input type="number" name="n" id="n"></div>
					<p id="content" class="menu_card_content"></p>
				</div>
			</div>
				
					
		
			<div id="displayOptions" class="card">
				<h2>Display Options</h2>
				<div>
					<input type="checkbox" id="displayCurve" name="displayCurve" value="displayCurve" checked>
				    <label for="displayCurve">Hide curves</label>
				</div>
				<div>
					<input type="checkbox" id="displayGrid" name="displayGrid" value="displayGrid">
				    <label for="displayGrid">Hide grid</label>
				</div>
			</div>
		</div>

	
	
	

	<script type="text/javascript" src="js/Point.js"></script>
	<script type="text/javascript" src="js/Elliptic.js"></script>
	<script type="text/javascript" src="js/Canvas.js"></script>

	<script>

		let ellipticCurve;

		let a = -7;
		let b = 10;
		let m = 17;

		let a_dom = document.querySelector('#a');
		let b_dom = document.querySelector('#b');
		let m_dom = document.querySelector('#m');
		let n_dom = document.querySelector('#n');

		a_dom.value = a;
		b_dom.value = b;
		m_dom.value = m;
		n_dom.value = n;

		refresh();


		// Refresh on input change
		var input = document.querySelectorAll('input');
		for(var i=0;i<input.length;i++){
	    	input[i].addEventListener('change', function(){  
	    		refresh();
	      	});
	    }

		function refresh() {
			a = a_dom.value;
			b = b_dom.value;
			m = m_dom.value;
			n = n_dom.value
			ellipticCurve = new Elliptic(a, b, m, 'canvas');
			ellipticCurve.drawModulo();
		}


		// Click on canvas

		var canvas = document.querySelector('#canvas');

		canvas.addEventListener('click', function(e) {
			var x;
			var y;
			if (e.pageX || e.pageY) { 
			  x = e.pageX;
			  y = e.pageY;
			} else { 
			  x = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft; 
			  y = e.clientY + document.body.scrollTop + document.documentElement.scrollTop; 
			} 

			x -= canvas.offsetLeft;
			y -= canvas.offsetTop;

			ellipticCurve.click(new Point(x, y));
		});
		
		// button function
		
	document.querySelector("[name='add']").onclick = function() {
		if (window.getComputedStyle(document.querySelector("[name='m2']")).display == "block"){
			document.querySelector("[name='m2']").style.display="none";
		}
		if (window.getComputedStyle(document.querySelector("[name='m1']")).display == 'none'){
			document.querySelector("[name='m1']").style.display="block";
		} else {
			document.querySelector("[name='m1']").style.display="none";
		}
		
	}
	document.querySelector("[name='mul']").onclick = function() {
		if (window.getComputedStyle(document.querySelector("[name='m1']")).display == "block"){
			document.querySelector("[name='m1']").style.display="none";
		}
		if (window.getComputedStyle(document.querySelector("[name='m2']")).display == 'none'){
			document.querySelector("[name='m2']").style.display="block";
		} else {
			document.querySelector("[name='m2']").style.display="none";
		}
	}
	</script>
</body>
</html>